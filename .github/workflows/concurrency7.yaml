name: concurrency test 7

on:
  workflow_dispatch:

# Job level concurrency 

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "🏗️ Building... ${{ github.workflow }}-${{ github.ref }}-${{github.run_number}}"
          sleep 60

  deploy:
    runs-on: ubuntu-latest
    needs: build
    concurrency:
      group: test1
      cancel-in-progress: true
    steps:
      - run: |
          echo "🚀 Deploying...${{ github.workflow }}-${{ github.ref }}-${{github.run_number}}"
          sleep 60


# ✅ Here's what will happen:
#  If triggerd one Time
#
# 💥 Since it had Needs on 2nd job which is depends on first it will execute fine
#

#--------------------------------
# 🤔 What happens if I trigger this workflow 4 times simultaneously,
# where each run contains two jobs (`build` and `deploy`), and both jobs
# use the same concurrency group (`test1`)?
#
# ✅ Outcome:
# 🕒 Time →
# [Run #1] build ──────────> deploy ─────┐
#                                        ╲ (canceled)
# [Run #2] build ──────────> deploy ─────┐
#                                        ╲ (canceled)
# [Run #3] build ──────────> deploy ─────┐
#                                        ╲ (canceled)
# [Run #4] build ──────────> deploy ─────✅ (runs completely)
